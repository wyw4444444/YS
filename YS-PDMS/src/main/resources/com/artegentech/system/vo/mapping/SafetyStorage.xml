<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://www.mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.artegentech.system.dao.ISafetyStorageDAO">
	<cache />
	<insert id="doCreate" parameterType="SafetyStorage" useGeneratedKeys="true" keyProperty="data_id">
		INSERT INTO tblsafety_storage(data_id,part_code,safety_stock,member_id,data_date)
		VALUES(#{data_id},#{part_code},#{safety_stock},#{member_id},#{data_date});
	</insert>
	<select id="findAll" resultType="SafetyStorage">
		SELECT data_id,part_code,safety_stock,member_id,data_date FROM tblsafety_storage
		ORDER BY part_code,data_id ASC;
	</select>
	<select id="findAllSplit" parameterType="java.util.Map" resultType="SafetyStorage">
		SELECT data_id,part_code,safety_stock,member_id,data_date FROM tblsafety_storage
		<where>
			<if test="column != null and keyword !=null">
				${column} LIKE #{keyword}
			</if>
		</where>
		ORDER BY part_code,data_id ASC
		LIMIT #{start},#{lineSize};
	</select>
	<select id="getAllCount" parameterType="java.util.Map" resultType="Long">
		SELECT COUNT(*) FROM tblsafety_storage
		<where>
			<if test="column !=null and keyword !=null">
				${column} LIKE #{keyword}
			</if>
		</where>
	</select>
	<select id="findAllLatest" resultType="SafetyStorage">
		SELECT data_id,part_code,safety_stock,member_id,data_date FROM tblsafety_storage
		WHERE data_id IN(SELECT max(data_id) data_id FROM tblsafety_storage GROUP BY part_code ORDER BY data_id DESC);
	</select>
	<select id="findAllLatestSplit" parameterType="java.util.Map" resultType="SafetyStorage">
		SELECT data_id,part_code,safety_stock,member_id,data_date FROM tblsafety_storage
		WHERE data_id IN(SELECT max(data_id) data_id FROM tblsafety_storage GROUP BY part_code ORDER BY data_id DESC)
		LIMIT #{start},#{lineSize};
	</select>
	<select id="getAllLatestCount" parameterType="java.util.Map" resultType="Long">
		SELECT COUNT(*) FROM tblsafety_storage
		WHERE data_id IN(SELECT max(data_id) data_id FROM tblsafety_storage GROUP BY part_code ORDER BY data_id DESC);
	</select>
	<select id="findByPartCode" parameterType="String" resultType="SafetyStorage">
		SELECT data_id,part_code,safety_stock,member_id,data_date FROM tblsafety_storage
		WHERE data_id IN(SELECT max(data_id) data_id FROM tblsafety_storage WHERE part_code=#{part_code});
	</select>
</mapper>